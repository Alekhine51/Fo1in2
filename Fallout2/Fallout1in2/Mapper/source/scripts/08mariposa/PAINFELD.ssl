/*

   Generic Painfield spatial script.

   NOTE:

      Only works if an actual red force field is on the same position.

*/

#include "..\headers\define.h"
#include "..\headers\command.h"

procedure start;
procedure spatial_p_proc;

procedure start begin
end

procedure spatial_p_proc begin
	if (tile_contains_obj_pid(self_tile, 0, PID_EW_PAIN_FIELD)) or (tile_contains_obj_pid(self_tile, 0, PID_NS_PAIN_FIELD)) then begin

      if fixt_enabled then begin
         if global_var(GVAR_MBASE_RED_ONLY_PLAYER) then begin
            if source_obj == dude_obj then begin
               critter_dmg(source_obj, random(10, 30), DMG_electrical);
            end
         end
         else if global_var(GVAR_MBASE_RED_ONLY_PARTY) then begin
            if (source_obj == dude_obj) then begin
               critter_dmg(source_obj, random(10, 30), DMG_electrical);
            end
         end
         else begin
            critter_dmg(source_obj, random(10, 30), DMG_electrical);
         end
      end
      else begin
         critter_dmg(source_obj, random(10, 30), DMG_electrical);
      end

	end
end
